webpackJsonp([18],{DxiS:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("Edqs"),o=s.n(a),n={data:function(){var t=this;return{params:{keyword:"",is_push:""},columns:[{title:"消息名称",key:"title"},{title:"消息内容",key:"content"},{title:"推送对象",key:"scope",width:150,render:function(t,e){return t("span",{},{1:"所有代理商",2:"一级代理商",3:"二级代理商"}[e.row.scope])}},{title:"是否已推送",key:"is_push",width:150,render:function(t,e){return t("span",{},{1:"是",2:"否"}[e.row.is_push])}},{title:"操作",width:150,key:"operation",render:function(e,s){return"2"==s.row.is_push?e("div",[e("span",{class:"span-active",on:{click:function(){t.handleStatus(s.row)}}},"推送"),e("span",{class:"span-active",on:{click:function(){t.handleEdit(s.row)}}},"编辑"),e("span",{class:"span-del",on:{click:function(){t.handleRemove("message/del",{id:s.row.id})}}},"删除")]):e("span",{},"-")}}],itemId:0,modal1:!1,firstList:[],secondList:[],formData:{title:"",content:"",scope:"1",users:[],is_push:"2"},rule:{}}},computed:{modelTitle:function(){return this.itemId?"编辑":"新增"}},mounted:function(){this.getFirstLevel(),this.getSecondLevel()},methods:{getFirstLevel:function(){var t=this;this.$post("agent/first-level",{page:0}).then(function(e){t.firstList=e.data})},getSecondLevel:function(){var t=this;this.$post("agent/second-level",{page:0}).then(function(e){t.secondList=e.data})},handleStatus:function(t){var e=this;this.$Modal.confirm({title:"温馨提示",content:"确定推送消息吗 ?",onOk:function(){e.$post("message/push",{id:t.id}).then(function(t){e.$Message.success("推送成功"),e.handleSearch()})},onCancel:function(){}})},radioChange:function(t){this.formData.users=[]},handleAdd:function(){this.modal1=!0,this.itemId=0,this.$refs.form.resetFields()},handleEdit:function(t){this.modal1=!0,this.itemId=t.id,this.formData=o()({},t),this.formData.users=t.users?t.users.split(","):[]},handleSubmit:function(){var t=this;this.itemId?this.$post("message/edit",{id:this.itemId,title:this.formData.title,content:this.formData.content,scope:this.formData.scope,users:this.formData.users.join(),is_push:this.formData.is_push}).then(function(e){t.modal1=!1,t.handleSearch()}):this.$post("message/add",{title:this.formData.title,content:this.formData.content,scope:this.formData.scope,users:this.formData.users.join(),is_push:this.formData.is_push}).then(function(e){t.modal1=!1,t.handleSearch()})}}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"dt-search-top"},[s("div",{staticClass:"dt-search-cells"},[s("div",{staticClass:"dt-search-cell"},[s("Input",{staticClass:"dt-search-input",attrs:{placeholder:"消息名称，消息内容"},model:{value:t.params.keyword,callback:function(e){t.$set(t.params,"keyword",e)},expression:"params.keyword"}})],1),t._v(" "),s("div",{staticClass:"dt-search-cell"},[t._v("\n        是否已推送：\n        "),s("Select",{staticClass:"dt-search-select",model:{value:t.params.is_push,callback:function(e){t.$set(t.params,"is_push",e)},expression:"params.is_push"}},[s("Option",{attrs:{value:"0"}},[t._v("全部")]),t._v(" "),s("Option",{attrs:{value:"1"}},[t._v("是")]),t._v(" "),s("Option",{attrs:{value:"2"}},[t._v("否")])],1)],1)]),t._v(" "),s("div",{staticClass:"dt-search-operation"},[s("Button",{attrs:{type:"ghost"},on:{click:t.handleSearch}},[t._v("查询")]),t._v(" "),s("Button",{attrs:{type:"success"},on:{click:t.handleAdd}},[t._v("新增")])],1)]),t._v(" "),s("dt-table",{ref:"table",attrs:{url:"message/list",params:t.params,columns:t.columns}}),t._v(" "),s("Modal",{attrs:{title:t.modelTitle,"mask-closable":!1},model:{value:t.modal1,callback:function(e){t.modal1=e},expression:"modal1"}},[s("Form",{ref:"form",attrs:{model:t.formData,rules:t.rule,"label-width":100}},[s("FormItem",{attrs:{label:"消息名称",prop:"title"}},[s("Input",{attrs:{placeholder:"请输入消息名称"},model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),t._v(" "),s("FormItem",{attrs:{label:"消息内容",prop:"content"}},[s("Input",{attrs:{type:"textarea",placeholder:"请输入消息内容"},model:{value:t.formData.content,callback:function(e){t.$set(t.formData,"content",e)},expression:"formData.content"}})],1),t._v(" "),s("FormItem",{attrs:{label:"推送对象",prop:"scope"}},[s("RadioGroup",{attrs:{vertical:""},on:{"on-change":t.radioChange},model:{value:t.formData.scope,callback:function(e){t.$set(t.formData,"scope",e)},expression:"formData.scope"}},[s("Radio",{attrs:{label:"1"}},[s("span",[t._v("所有代理商")])]),t._v(" "),s("Radio",{attrs:{label:"2"}},[s("span",[t._v("一级代理商")])]),t._v(" "),s("Radio",{attrs:{label:"3"}},[s("span",[t._v("二级代理商")])])],1)],1),t._v(" "),"1"!=t.formData.scope?s("FormItem",{attrs:{label:"选择代理商",prop:"users"}},["2"==t.formData.scope?s("CheckboxGroup",{model:{value:t.formData.users,callback:function(e){t.$set(t.formData,"users",e)},expression:"formData.users"}},t._l(t.firstList,function(e,a){return s("Checkbox",{key:a,staticStyle:{display:"block"},attrs:{label:e.id}},[s("span",[t._v(t._s(e.realname))])])})):t._e(),t._v(" "),"3"==t.formData.scope?s("CheckboxGroup",{model:{value:t.formData.users,callback:function(e){t.$set(t.formData,"users",e)},expression:"formData.users"}},t._l(t.secondList,function(e,a){return s("Checkbox",{key:a,staticStyle:{display:"block"},attrs:{label:e.id}},[s("span",[t._v(t._s(e.realname))])])})):t._e()],1):t._e()],1),t._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{type:"ghost"},on:{click:function(e){t.handleSubmit()}}},[t._v("保存")]),t._v(" "),s("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"text"},on:{click:function(e){t.modal1=!1}}},[t._v("取消")])],1)],1)],1)},staticRenderFns:[]},r=s("Mz/3")(n,i,!1,null,null,null);e.default=r.exports}});
//# sourceMappingURL=18.7154206b3f9fe6adf9a9.js.map