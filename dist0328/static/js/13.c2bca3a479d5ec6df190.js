webpackJsonp([13],{XP5l:function(t,a){},dnnZ:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var o=e("Edqs"),n=e.n(o),l={data:function(){var t=this;return{uploadData:{target:"icon"},params:{keyword:""},columns:[{title:"流程编码",key:"code"},{title:"流程名称",key:"name"},{title:"流程描述",key:"descr"},{title:"流程发起人",key:"sponsor_type",width:150,render:function(t,a){return t("span",{},{1:"酷蛙小二",2:"一级代理",3:"二级代理",4:"运营人员",5:"流程发起人",6:"第三方系统用户"}[a.row.sponsor_type])}},{title:"更新时间",key:"utime",width:150,render:function(t,a){return t("span",{},new Date(1e3*a.row.utime).Format("yyyy-MM-dd hh:mm"))}},{title:"操作",width:200,key:"operation",render:function(a,e){return a("div",[a("span",{class:"span-active",on:{click:function(){t.handleStatus(e.row)}}},{2:"启用",1:"禁用"}[e.row.is_enable]),a("span",{class:"span-active",on:{click:function(){t.handleEdit(e.row)}}},"编辑"),a("span",{class:"span-del",on:{click:function(){t.handleRemove("flow/del",{id:e.row.id})}}},"删除")])}}],itemId:0,modal1:!1,defaultList:[],formData:{type:"1",name:"",descr:"",sponsor_type:"",can_del:"",icon:"",gen_delay:!1,gen_spread:!1,gen_install:!1,gen_renew:!1,gen_achieve:!1,gen_comments:!1,gen_stock_in:!1,gen_stock_out:!1,nodes:[]},rule:{},flowList:[],modal2:!1,formData2:{flow_id:"",node_num:"",node_name:"",handler_type:"",handler_uid:[],handle_duration:"",delay_remind:"",default_pass:"",default_pass_duration:""}}},computed:{modelTitle:function(){return this.itemId?"编辑":"录入"}},mounted:function(){this.getFlowList()},methods:{getFlowList:function(){var t=this;this.$post("flow/handler",{page:0}).then(function(a){t.flowList=a.data,console.log(t.flowList)})},handleStatus:function(t){var a=this;this.$Modal.confirm({title:"温馨提示",content:"确定"+("1"==t.is_enable?"禁用":"启用")+"流程吗 ?",onOk:function(){a.$post("flow/setstatus",{id:t.id,is_enable:"1"==t.is_enable?"2":"1"}).then(function(t){a.$Message.success("操作成功"),a.handleSearch()})},onCancel:function(){}})},onSuccess:function(t,a,e){this.formData.icon=t.data.path},handleAdd:function(t){this.modal1=!0,this.itemId=0,this.$refs.form.resetFields(),this.formData.type=t,this.formData.nodes=[],this.formData.gen_delay=!1,this.formData.gen_spread=!1,this.formData.gen_install=!1,this.formData.gen_renew=!1,this.formData.gen_achieve=!1,this.formData.gen_comments=!1,this.formData.gen_stock_in=!1,this.formData.gen_stock_out=!1},handleEdit:function(t){var a=this;this.modal1=!0,this.itemId=t.id,this.$post("flow/detail",{id:t.id}).then(function(t){var e=t.data;a.formData=n()({},e),a.formData.gen_delay="1"==e.gen_delay,a.formData.gen_spread="1"==e.gen_spread,a.formData.gen_install="1"==e.gen_install,a.formData.gen_renew="1"==e.gen_renew,a.formData.gen_achieve="1"==e.gen_achieve,a.formData.gen_comments="1"==e.gen_comments,a.formData.gen_stock_in="1"==e.gen_stock_in,a.formData.gen_stock_out="1"==e.gen_stock_out})},handleSubmit:function(){var t=this,a=n()({},this.formData);a.gen_delay=a.gen_delay?"1":"2",a.gen_spread=a.gen_spread?"1":"2",a.gen_install=a.gen_install?"1":"2",a.gen_renew=a.gen_renew?"1":"2",a.gen_achieve=a.gen_achieve?"1":"2",a.gen_comments=a.gen_comments?"1":"2",a.gen_stock_in=a.gen_stock_in?"1":"2",a.gen_stock_out=a.gen_stock_out?"1":"2",this.itemId?(a=n()({},a,{id:this.itemId}),this.$post("flow/edit",a).then(function(a){t.modal1=!1,t.modal2=!1,t.handleSearch()})):(a=n()({},a),this.$post("flow/add",a).then(function(a){t.modal1=!1,t.modal2=!1,t.handleSearch()}))},add:function(){this.modal1=!1,this.modal2=!0;this.indexItem=-1,this.formData2=n()({},{node_name:"",handler_type:"",handler_uid:[],handle_duration:"",delay_remind:"",default_pass:"",default_pass_duration:""})},edit:function(t,a){this.modal1=!1,this.modal2=!0,this.indexItem=a,this.formData2=n()({},t)},handleSubmit2:function(){-1==this.indexItem?this.formData.nodes.push(this.formData2):this.formData.nodes.splice(this.indexItem,1,this.formData2),this.modal1=!0,this.modal2=!1},handleCancel:function(){}}},s={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"dt-search-top"},[e("div",{staticClass:"dt-search-cells"},[e("div",{staticClass:"dt-search-cell"},[e("Input",{staticClass:"dt-search-input",staticStyle:{width:"350px"},attrs:{placeholder:"流程名称、流程编码"},model:{value:t.params.keyword,callback:function(a){t.$set(t.params,"keyword",a)},expression:"params.keyword"}})],1)]),t._v(" "),e("div",{staticClass:"dt-search-operation"},[e("Button",{attrs:{type:"ghost"},on:{click:t.handleSearch}},[t._v("查询")]),t._v(" "),e("Button",{attrs:{type:"success"},on:{click:function(a){t.handleAdd(1)}}},[t._v("新增通用流程")]),t._v(" "),e("Button",{attrs:{type:"info"},on:{click:function(a){t.handleAdd(2)}}},[t._v("新增进出库流程")])],1)]),t._v(" "),e("dt-table",{ref:"table",attrs:{url:"flow/list",params:t.params,columns:t.columns}}),t._v(" "),e("Modal",{attrs:{title:t.modelTitle,"mask-closable":!1},model:{value:t.modal1,callback:function(a){t.modal1=a},expression:"modal1"}},[e("Form",{ref:"form",attrs:{model:t.formData,rules:t.rule,"label-width":100}},[e("FormItem",{attrs:{label:"流程名称",prop:"name"}},[e("Input",{attrs:{placeholder:"请输入流程名称"},model:{value:t.formData.name,callback:function(a){t.$set(t.formData,"name",a)},expression:"formData.name"}})],1),t._v(" "),e("FormItem",{attrs:{label:"流程描述",prop:"descr"}},[e("Input",{attrs:{type:"textarea",placeholder:"请输入流程描述"},model:{value:t.formData.descr,callback:function(a){t.$set(t.formData,"descr",a)},expression:"formData.descr"}})],1),t._v(" "),e("FormItem",{attrs:{label:"流程发起人",prop:"sponsor_type"}},[e("RadioGroup",{attrs:{vertical:""},model:{value:t.formData.sponsor_type,callback:function(a){t.$set(t.formData,"sponsor_type",a)},expression:"formData.sponsor_type"}},[e("Radio",{attrs:{label:"5"}},[e("span",[t._v("流程发起人")])]),t._v(" "),e("Radio",{attrs:{label:"1"}},[e("span",[t._v("酷蛙小二")])]),t._v(" "),e("Radio",{attrs:{label:"2"}},[e("span",[t._v("一级代理商")])]),t._v(" "),e("Radio",{attrs:{label:"3"}},[e("span",[t._v("二级代理商")])]),t._v(" "),e("Radio",{attrs:{label:"4"}},[e("span",[t._v("运营人员")])]),t._v(" "),e("Radio",{attrs:{label:"6"}},[e("span",[t._v("第三方系统用户")])])],1)],1),t._v(" "),e("FormItem",{attrs:{label:"是否可删除",prop:"can_del"}},[e("Select",{model:{value:t.formData.can_del,callback:function(a){t.$set(t.formData,"can_del",a)},expression:"formData.can_del"}},[e("Option",{attrs:{value:"1"}},[t._v("是")]),t._v(" "),e("Option",{attrs:{value:"2"}},[t._v("否")])],1)],1),t._v(" "),e("FormItem",{attrs:{label:"流程图标",prop:"icon"}},[t.formData.icon?e("img",{staticClass:"formItemImg",attrs:{src:t.formData.icon}}):t._e(),t._v(" "),e("Upload",{staticStyle:{width:"60px",display:"inline-block"},attrs:{type:"drag",action:"http://120.24.55.58:8146//upload/upload","show-upload-list":!1,"default-file-list":t.defaultList,data:t.uploadData,name:"image",accept:".png, .jpg, .jpeg, .gif","on-success":t.onSuccess}},[e("div",{staticStyle:{padding:"10px 0"}},[e("Icon",{attrs:{type:"plus",size:"30"}})],1)]),t._v(" "),e("p",{staticStyle:{display:"inline-block"}},[t._v("200*200px图标")])],1),t._v(" "),e("FormItem",{attrs:{label:"主题"}},[e("Input",{attrs:{disabled:"",placeholder:"如：更换滤芯"}})],1),t._v(" "),"2"==t.formData.type?e("FormItem",{attrs:{label:"货物"}},[e("Input",{attrs:{disabled:"",placeholder:"10001/净水器"}})],1):t._e(),t._v(" "),"2"==t.formData.type?e("FormItem",{attrs:{label:"数量"}},[e("Input",{attrs:{disabled:"",placeholder:"如：提一件滤芯"}})],1):t._e(),t._v(" "),e("FormItem",{attrs:{label:"内容"}},[e("Input",{attrs:{type:"textarea",disabled:"",placeholder:"详细的内容资料，如设备ID，需要服务内容描述"}})],1),t._v(" "),e("FormItem",{attrs:{label:"图片",prop:"icon"}},[e("div",{staticStyle:{width:"60px",display:"inline-block",padding:"10px 0",border:"1px dashed #dddee1","text-align":"center"}},[e("Icon",{attrs:{type:"plus",size:"30"}})],1)]),t._v(" "),e("FormItem",{attrs:{label:"流程设计",prop:"role_name"}},[t._l(t.formData.nodes,function(a,o){return e("div",{staticClass:"tip",on:{click:function(e){t.edit(a,o)}}},[e("span",[t._v(t._s(a.node_name))])])}),t._v(" "),e("div",{staticClass:"add",on:{click:t.add}},[e("span",[t._v("添加新流程")])])],2),t._v(" "),e("FormItem",{attrs:{label:"高级设置"}},[e("h3",[t._v("完成流程后，系统处理事宜")]),t._v(" "),"1"==t.formData.type?e("Checkbox",{staticStyle:{display:"block"},model:{value:t.formData.gen_delay,callback:function(a){t.$set(t.formData,"gen_delay",a)},expression:"formData.gen_delay"}},[e("span",[t._v("记录延期")])]):t._e(),t._v(" "),"1"==t.formData.type?e("Checkbox",{staticStyle:{display:"block"},model:{value:t.formData.gen_spread,callback:function(a){t.$set(t.formData,"gen_spread",a)},expression:"formData.gen_spread"}},[e("span",[t._v("生成推广费用")])]):t._e(),t._v(" "),"1"==t.formData.type?e("Checkbox",{staticStyle:{display:"block"},model:{value:t.formData.gen_install,callback:function(a){t.$set(t.formData,"gen_install",a)},expression:"formData.gen_install"}},[e("span",[t._v("生成装机费用")])]):t._e(),t._v(" "),"1"==t.formData.type?e("Checkbox",{staticStyle:{display:"block"},model:{value:t.formData.gen_renew,callback:function(a){t.$set(t.formData,"gen_renew",a)},expression:"formData.gen_renew"}},[e("span",[t._v("生成续费奖励费用")])]):t._e(),t._v(" "),"1"==t.formData.type?e("Checkbox",{staticStyle:{display:"block"},model:{value:t.formData.gen_achieve,callback:function(a){t.$set(t.formData,"gen_achieve",a)},expression:"formData.gen_achieve"}},[e("span",[t._v("生成达标奖励")])]):t._e(),t._v(" "),"1"==t.formData.type?e("Checkbox",{staticStyle:{display:"block"},model:{value:t.formData.gen_comments,callback:function(a){t.$set(t.formData,"gen_comments",a)},expression:"formData.gen_comments"}},[e("span",[t._v("生成评价表")])]):t._e(),t._v(" "),"2"==t.formData.type?e("Checkbox",{staticStyle:{display:"block"},model:{value:t.formData.gen_stock_in,callback:function(a){t.$set(t.formData,"gen_stock_in",a)},expression:"formData.gen_stock_in"}},[e("span",[t._v("更新出库记录")])]):t._e(),t._v(" "),"2"==t.formData.type?e("Checkbox",{staticStyle:{display:"block"},model:{value:t.formData.gen_stock_out,callback:function(a){t.$set(t.formData,"gen_stock_out",a)},expression:"formData.gen_stock_out"}},[e("span",[t._v("更新出库记录")])]):t._e()],1)],1),t._v(" "),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{type:"ghost"},on:{click:function(a){t.handleSubmit()}}},[t._v("保存")]),t._v(" "),e("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"text"},on:{click:function(a){t.modal1=!1}}},[t._v("取消")])],1)],1),t._v(" "),e("Modal",{attrs:{title:"流程节点","mask-closable":!1},on:{"on-cancel":function(a){t.modal1=!0,t.modal2=!1}},model:{value:t.modal2,callback:function(a){t.modal2=a},expression:"modal2"}},[e("Form",{ref:"form2",attrs:{model:t.formData2,rules:t.rule,"label-width":100}},[e("FormItem",{attrs:{label:"节点名称",prop:"node_name"}},[e("Input",{attrs:{placeholder:"请输入节点名称"},model:{value:t.formData2.node_name,callback:function(a){t.$set(t.formData2,"node_name",a)},expression:"formData2.node_name"}})],1),t._v(" "),e("FormItem",{attrs:{label:"处理人",prop:"handler_type"}},[e("div",{staticStyle:{height:"200px","overflow-y":"scroll",border:"1px solid #dddee1",padding:"0px 10px"}},[e("RadioGroup",{attrs:{vertical:""},model:{value:t.formData2.handler_type,callback:function(a){t.$set(t.formData2,"handler_type",a)},expression:"formData2.handler_type"}},t._l(t.flowList,function(a,o){return e("Radio",{key:o,attrs:{label:a.sponsor_type}},[e("span",[t._v(t._s(a.sponsor_name))]),t._v(" "),a.children?e("CheckboxGroup",{model:{value:t.formData2.handler_uid,callback:function(a){t.$set(t.formData2,"handler_uid",a)},expression:"formData2.handler_uid"}},t._l(a.children,function(a,o){return e("Checkbox",{key:o,staticStyle:{display:"block","margin-left":"25px"},attrs:{label:a.id}},[e("span",[t._v(t._s(a.realname))])])})):t._e()],1)}))],1)]),t._v(" "),e("FormItem",{attrs:{label:"处理时间",prop:"handle_duration"}},[e("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入处理时间"},model:{value:t.formData2.handle_duration,callback:function(a){t.$set(t.formData2,"handle_duration",a)},expression:"formData2.handle_duration"}}),t._v(" "),e("span",{staticStyle:{padding:"0px 5px"}},[t._v("小时")])],1),t._v(" "),e("FormItem",{attrs:{label:"延期提醒",prop:"delay_remind"}},[e("Select",{model:{value:t.formData2.delay_remind,callback:function(a){t.$set(t.formData2,"delay_remind",a)},expression:"formData2.delay_remind"}},[e("Option",{attrs:{value:"1"}},[t._v("开启")]),t._v(" "),e("Option",{attrs:{value:"2"}},[t._v("关闭")])],1)],1),t._v(" "),e("FormItem",{attrs:{label:"默认通过",prop:"default_pass"}},[e("Select",{model:{value:t.formData2.default_pass,callback:function(a){t.$set(t.formData2,"default_pass",a)},expression:"formData2.default_pass"}},[e("Option",{attrs:{value:"1"}},[t._v("开启")]),t._v(" "),e("Option",{attrs:{value:"2"}},[t._v("关闭")])],1)],1),t._v(" "),e("FormItem",{attrs:{label:"默认通过时长",prop:"default_pass_duration"}},[e("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入默认通过时长"},model:{value:t.formData2.default_pass_duration,callback:function(a){t.$set(t.formData2,"default_pass_duration",a)},expression:"formData2.default_pass_duration"}}),t._v(" "),e("span",{staticStyle:{padding:"0px 5px"}},[t._v("小时")])],1)],1),t._v(" "),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{type:"ghost"},on:{click:function(a){t.handleSubmit2()}}},[t._v("保存")]),t._v(" "),e("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"text"},on:{click:function(a){t.modal1=!0,t.modal2=!1}}},[t._v("取消")])],1)],1)],1)},staticRenderFns:[]};var r=e("Mz/3")(l,s,!1,function(t){e("XP5l")},"data-v-40792a34",null);a.default=r.exports}});
//# sourceMappingURL=13.c2bca3a479d5ec6df190.js.map