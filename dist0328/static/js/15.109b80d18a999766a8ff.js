webpackJsonp([15],{G1Dl:function(t,a){},jcz4:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("34v0"),l=e.n(s),n=e("Edqs"),r=e.n(n),o={data:function(){var t=this;return{params:{keyword:"",level:"0",first_level:"",status:"0",code:[],month_salary:"",total_salary:"",points:""},columns:[{title:"账号",key:"username",width:150},{title:"姓名",key:"realname",width:150},{title:"手机号码",key:"phone",width:150},{title:"等级",key:"level",width:100,render:function(t,a){return t("span",{},{1:"一级",2:"二级"}[a.row.status])}},{title:"上一级",key:"parent",width:150,render:function(t,a){return t("span",{},a.row.parent&&a.row.parent.realname+"/"+a.row.parent.phone)}},{title:"状态",key:"status",width:100,render:function(t,a){return t("span",{},{1:"正常",2:"禁用"}[a.row.status])}},{title:"月收入",key:"month_salary",width:150,render:function(t,a){return t("span",{},a.row.extend&&a.row.extend.month_salary)}},{title:"总收入",key:"total_salary",width:150,render:function(t,a){return t("span",{},a.row.extend&&a.row.extend.total_salary)}},{title:"总体评分",key:"total_points",width:150,render:function(t,a){return t("span",{},a.row.extend&&a.row.extend.total_points)}},{title:"地址",key:"address",width:250,render:function(t,a){return t("span",{},a.row.address)}},{title:"添加人",key:"creator",width:150,render:function(t,a){return t("span",{},a.row.creator&&a.row.creator.realname+"/"+a.row.creator.phone)}},{title:"添加时间",key:"ctime",width:150,render:function(t,a){return t("span",{},new Date(1e3*a.row.ctime).Format("yyyy-MM-dd hh:mm"))}},{title:"操作",width:300,key:"operation",render:function(a,e){return a("div",[a("span",{class:"span-active",on:{click:function(){t.handleSync(e.row)}}},"同步设备"),a("span",{class:"span-active",on:{click:function(){t.handleDetail(e.row)}}},"运营详情"),a("span",{class:"span-active",on:{click:function(){t.handleReset(e.row)}}},"密码初始化"),a("span",{class:"span-active",on:{click:function(){t.handleEdit(e.row)}}},"编辑"),a("span",{class:"span-del",on:{click:function(){t.handleRemove("agent/del",{id:e.row.id})}}},"删除")])}}],itemId:0,modal1:!1,firstList:[],roleList:[],formData:{username:"",realname:"",phone:"",level:"",pid:"",status:"1",role_id:"",code:["北京市","市辖区","东城区"],province:"北京市",city:"市辖区",district:"东城区",address:"",longitude:"",latitude:"",serve_range:"1",bank_card:"",spread_fee:"",spread_time:"",install_fee:"",service_fee:"",renew_fee:"",renew_time:"",achieve_reward:"",achieve_num:""},rule:{},modal2:!1,detail:{remain_money:"",month_salary:"",device_num:"",new_device_num:"",month_order_num:"",month_points:0,month_star_info:{},month_comments_info:{},total_salary:"",total_order_num:"",total_points:0,total_star_info:{},total_comments_info:{}}}},computed:{modelTitle:function(){return this.itemId?"编辑":"新增"}},mounted:function(){this.getFirstLevel(),this.getRoleList()},methods:{getFirstLevel:function(){var t=this;this.$post("agent/first-level",{page:0}).then(function(a){t.firstList=a.data})},getRoleList:function(){var t=this;this.$post("role/list",{page:0}).then(function(a){t.roleList=a.data.list})},areaChange:function(t){1==t.length&&(this.params.province=t[0]),2==t.length&&(this.params.province=t[0],this.params.city=t[1]),3==t.length&&(this.params.province=t[0],this.params.city=t[1],this.params.district=t[2])},areaChangeModal:function(t){1==t.length&&(this.formData.province=t[0]),2==t.length&&(this.formData.province=t[0],this.formData.city=t[1]),3==t.length&&(this.formData.province=t[0],this.formData.city=t[1],this.formData.district=t[2])},loadMap:function(){var t=this,a=new AMap.Map(this.$refs.map,{zoom:16,resizeEnable:!0});this.map=a,this.formData.longitude&&(a.setZoom(15),a.setCenter([this.formData.longitude,this.formData.latitude]),t.loadCircle());var e=new AMap.Autocomplete({input:"search"});AMap.event.addListener(e,"select",function(e){e.poi&&e.poi.location&&(a.setZoom(15),a.setCenter(e.poi.location),t.formData.longitude=e.poi.location.lng,t.formData.latitude=e.poi.location.lat,t.formData.address=e.poi.name,t.loadCircle())})},loadCircle:function(){var t=new AMap.Circle({center:[this.formData.longitude,this.formData.latitude],radius:1e3*Number(this.formData.serve_range),strokeColor:"#1791fc",strokeWeight:1,strokeOpacity:.4,fillColor:"#1791fc",fillOpacity:.4,zIndex:50});this.map.clearMap(),this.map.add(t)},handleSync:function(t){var a=this;this.$Modal.confirm({title:"温馨提示",content:"确定同步设备 ?",onOk:function(){a.$post("agent/device-sync",{agent_id:t.id}).then(function(t){a.$Message.success("同步成功"),a.handleSearch()})},onCancel:function(){}})},handleReset:function(t){var a=this;this.$Modal.confirm({title:"温馨提示",content:"确定重置密码 ?",onOk:function(){a.$post("agent/resetpwd",{id:t.id}).then(function(t){a.$Message.success("重置成功"),a.handleSearch()})},onCancel:function(){}})},handleAdd:function(){this.modal1=!0,this.itemId=0,this.$refs.form.resetFields(),this.$refs.code.isInit=!0,this.formData.code=["北京市","市辖区","东城区"],this.formData.longitude="",this.formData.latitude="",this.map&&this.map.destroy(),this.loadMap()},handleEdit:function(t){this.modal1=!0,this.itemId=t.id,this.formData=r()(this.formData,t,t.extend),this.$refs.code.isInit=!0,this.formData.code=[t.province,t.city,t.district],this.map&&this.map.destroy(),this.loadMap()},handleSubmit:function(){var t=this;if(console.log(this.formData),!/^1[0-9]{10}$/.test(this.formData.phone))return this.$Message.destroy(),void this.$Message.warning("请输入正确格式的手机号");var a={};this.itemId?(a=r()({},this.formData,{id:this.itemId}),this.$post("agent/edit",a).then(function(a){t.modal1=!1,t.handleSearch()})):(a=r()({},this.formData),this.$post("agent/add",a).then(function(a){t.modal1=!1,t.handleSearch()}))},handleDetail:function(t){this.modal2=!0,this.detail=r()({},t.extend),this.detail.month_points=parseFloat(t.extend.month_points)/2,this.detail.total_points=parseFloat(t.extend.total_points)/2,console.log(this.detail)},handleExport:function(){var t=this;this.$Modal.confirm({title:"温馨提示",content:"确定导出数据 ?",onOk:function(){t.$post("finance/list",l()({},t.params,{export:1})).then(function(t){window.location.href=t.data.filename})},onCancel:function(){}})}}},i={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"dt-search-top"},[e("div",{staticClass:"dt-search-cells"},[e("div",{staticClass:"dt-search-cell"},[e("Input",{staticClass:"dt-search-input",staticStyle:{width:"350px"},attrs:{placeholder:"账号、姓名、手机号码"},model:{value:t.params.keyword,callback:function(a){t.$set(t.params,"keyword",a)},expression:"params.keyword"}})],1),t._v(" "),e("div",{staticClass:"dt-search-cell"},[t._v("\n        等级：\n        "),e("dt-select",{staticClass:"dt-search-select",attrs:{url:"userLevel"},model:{value:t.params.level,callback:function(a){t.$set(t.params,"level",a)},expression:"params.level"}})],1),t._v(" "),e("div",{staticClass:"dt-search-cell"},[t._v("\n        上一级：\n        "),e("Select",{staticClass:"dt-search-select",model:{value:t.params.first_level,callback:function(a){t.$set(t.params,"first_level",a)},expression:"params.first_level"}},[e("Option",{key:"-1",attrs:{value:"0"}},[t._v("全部")]),t._v(" "),t._l(t.firstList,function(a){return e("Option",{key:a.id,attrs:{value:a.id}},[t._v(t._s(a.realname)+"/"+t._s(a.phone))])})],2)],1),t._v(" "),e("div",{staticClass:"dt-search-cell"},[t._v("\n        状态：\n        "),e("dt-select",{staticClass:"dt-search-select",attrs:{url:"userStatus"},model:{value:t.params.status,callback:function(a){t.$set(t.params,"status",a)},expression:"params.status"}})],1),t._v(" "),e("div",{staticClass:"dt-search-cell"},[t._v("\n        省市区：\n        "),e("al-selector",{staticClass:"dt-search-area",attrs:{"data-type":"name",level:"2"},on:{"on-change":t.areaChange},model:{value:t.params.code,callback:function(a){t.$set(t.params,"code",a)},expression:"params.code"}})],1),t._v(" "),e("div",{staticClass:"dt-search-cell"},[t._v("\n        月收入大于：\n        "),e("Input",{staticClass:"dt-search-input",attrs:{placeholder:"月收入金额"},model:{value:t.params.month_salary,callback:function(a){t.$set(t.params,"month_salary",a)},expression:"params.month_salary"}})],1),t._v(" "),e("div",{staticClass:"dt-search-cell"},[t._v("\n        总收入大于：\n        "),e("Input",{staticClass:"dt-search-input",attrs:{placeholder:"总收入金额"},model:{value:t.params.total_salary,callback:function(a){t.$set(t.params,"total_salary",a)},expression:"params.total_salary"}})],1),t._v(" "),e("div",{staticClass:"dt-search-cell"},[t._v("\n        总体评分大于：\n        "),e("Input",{staticClass:"dt-search-input",attrs:{placeholder:"总体评分"},model:{value:t.params.points,callback:function(a){t.$set(t.params,"points",a)},expression:"params.points"}})],1)]),t._v(" "),e("div",{staticClass:"dt-search-operation"},[e("Button",{attrs:{type:"ghost"},on:{click:t.handleSearch}},[t._v("查询")]),t._v(" "),e("Button",{attrs:{type:"success"},on:{click:t.handleAdd}},[t._v("新增")]),t._v(" "),e("Button",{attrs:{type:"info"},on:{click:t.handleExport}},[t._v("导出")])],1)]),t._v(" "),e("dt-table",{ref:"table",attrs:{url:"agent/list",params:t.params,columns:t.columns}}),t._v(" "),e("Modal",{attrs:{title:t.modelTitle,"mask-closable":!1},model:{value:t.modal1,callback:function(a){t.modal1=a},expression:"modal1"}},[e("Form",{ref:"form",attrs:{model:t.formData,rules:t.rule,"label-width":100}},[e("FormItem",{attrs:{label:"账号",prop:"username"}},[e("Input",{attrs:{placeholder:"请输入账号"},model:{value:t.formData.username,callback:function(a){t.$set(t.formData,"username",a)},expression:"formData.username"}})],1),t._v(" "),e("FormItem",{attrs:{label:"姓名",prop:"realname"}},[e("Input",{attrs:{placeholder:"请输入姓名"},model:{value:t.formData.realname,callback:function(a){t.$set(t.formData,"realname",a)},expression:"formData.realname"}})],1),t._v(" "),e("FormItem",{attrs:{label:"手机号码",prop:"phone"}},[e("Input",{attrs:{placeholder:"请输入手机号码"},model:{value:t.formData.phone,callback:function(a){t.$set(t.formData,"phone",a)},expression:"formData.phone"}})],1),t._v(" "),e("FormItem",{attrs:{label:"等级",prop:"level"}},[e("dt-select",{staticClass:"dt-search-select",attrs:{url:"userLevelModal"},model:{value:t.formData.level,callback:function(a){t.$set(t.formData,"level",a)},expression:"formData.level"}})],1),t._v(" "),e("FormItem",{attrs:{label:"上一级",prop:"pid"}},[e("Select",{model:{value:t.formData.pid,callback:function(a){t.$set(t.formData,"pid",a)},expression:"formData.pid"}},t._l(t.firstList,function(a){return e("Option",{key:a.id,attrs:{value:a.id}},[t._v(t._s(a.realname)+"/"+t._s(a.phone))])}))],1),t._v(" "),e("FormItem",{attrs:{label:"状态",prop:"status"}},[e("dt-select",{staticClass:"dt-search-select",attrs:{url:"userStatusModal"},model:{value:t.formData.status,callback:function(a){t.$set(t.formData,"status",a)},expression:"formData.status"}})],1),t._v(" "),e("FormItem",{attrs:{label:"角色",prop:"role_id"}},[e("Select",{model:{value:t.formData.role_id,callback:function(a){t.$set(t.formData,"role_id",a)},expression:"formData.role_id"}},t._l(t.roleList,function(a){return e("Option",{key:a.id,attrs:{value:a.id}},[t._v(t._s(a.role_name))])}))],1),t._v(" "),e("FormItem",{attrs:{label:"省市区",prop:"code"}},[e("al-selector",{ref:"code",staticStyle:{display:"flow-root"},attrs:{"data-type":"name",level:"2"},on:{"on-change":t.areaChangeModal},model:{value:t.formData.code,callback:function(a){t.$set(t.formData,"code",a)},expression:"formData.code"}})],1),t._v(" "),e("FormItem",{attrs:{label:"详细地址",prop:"address"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.address,expression:"formData.address"}],ref:"search",staticClass:"ivu-input",attrs:{type:"text",id:"search",placeholder:"请输入详细地址"},domProps:{value:t.formData.address},on:{input:function(a){a.target.composing||t.$set(t.formData,"address",a.target.value)}}}),t._v(" "),e("div",{ref:"map",staticClass:"pickerMap"})]),t._v(" "),e("FormItem",{attrs:{label:"服务范围",prop:"serve_range"}},[e("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入服务范围"},on:{"on-change":t.loadCircle},model:{value:t.formData.serve_range,callback:function(a){t.$set(t.formData,"serve_range",a)},expression:"formData.serve_range"}}),t._v(" "),e("span",{staticStyle:{padding:"0px 5px"}},[t._v("公里")])],1),t._v(" "),e("FormItem",{attrs:{label:"银行卡号",prop:"bank_card"}},[e("Input",{attrs:{placeholder:"提现时候使用的银行卡号"},model:{value:t.formData.bank_card,callback:function(a){t.$set(t.formData,"bank_card",a)},expression:"formData.bank_card"}})],1),t._v(" "),e("FormItem",{attrs:{label:"推广费用",prop:"spread_fee"}},[e("Input",{attrs:{placeholder:"推广设备，激活后得到的费用"},model:{value:t.formData.spread_fee,callback:function(a){t.$set(t.formData,"spread_fee",a)},expression:"formData.spread_fee"}})],1),t._v(" "),e("FormItem",{attrs:{label:"推广时长",prop:"spread_time"}},[e("Input",{attrs:{placeholder:"设备需要激活的时长"},model:{value:t.formData.spread_time,callback:function(a){t.$set(t.formData,"spread_time",a)},expression:"formData.spread_time"}})],1),t._v(" "),e("FormItem",{attrs:{label:"装机费用",prop:"install_fee"}},[e("Input",{attrs:{placeholder:"安装一台机器，获得的费用"},model:{value:t.formData.install_fee,callback:function(a){t.$set(t.formData,"install_fee",a)},expression:"formData.install_fee"}})],1),t._v(" "),e("FormItem",{attrs:{label:"售后服务费用",prop:"service_fee"}},[e("Input",{attrs:{placeholder:"每个月每台机器的服务费用"},model:{value:t.formData.service_fee,callback:function(a){t.$set(t.formData,"service_fee",a)},expression:"formData.service_fee"}})],1),t._v(" "),e("FormItem",{attrs:{label:"续费费用",prop:"renew_fee"}},[e("Input",{attrs:{placeholder:"完成第一次续费，奖励金额"},model:{value:t.formData.renew_fee,callback:function(a){t.$set(t.formData,"renew_fee",a)},expression:"formData.renew_fee"}})],1),t._v(" "),e("FormItem",{attrs:{label:"续费时长",prop:"renew_time"}},[e("Input",{attrs:{placeholder:"续费时长，天数"},model:{value:t.formData.renew_time,callback:function(a){t.$set(t.formData,"renew_time",a)},expression:"formData.renew_time"}})],1),t._v(" "),e("FormItem",{attrs:{label:"达标奖励",prop:"achieve_reward"}},[e("Input",{attrs:{placeholder:"达标奖励金额"},model:{value:t.formData.achieve_reward,callback:function(a){t.$set(t.formData,"achieve_reward",a)},expression:"formData.achieve_reward"}})],1),t._v(" "),e("FormItem",{attrs:{label:"达标数量",prop:"achieve_num"}},[e("Input",{attrs:{placeholder:"月度新增激活设备量"},model:{value:t.formData.achieve_num,callback:function(a){t.$set(t.formData,"achieve_num",a)},expression:"formData.achieve_num"}})],1)],1),t._v(" "),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{type:"ghost"},on:{click:function(a){t.handleSubmit()}}},[t._v("保存")]),t._v(" "),e("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"text"},on:{click:function(a){t.modal1=!1}}},[t._v("取消")])],1)],1),t._v(" "),e("Modal",{attrs:{title:"运营详情","mask-closable":!1,width:"650"},model:{value:t.modal2,callback:function(a){t.modal2=a},expression:"modal2"}},[e("h1",[t._v("余额: "+t._s(t.detail.remain_money)+"元")]),t._v(" "),e("Row",{attrs:{gutter:40}},[e("Col",{attrs:{span:"12"}},[e("h2",{staticClass:"title"},[t._v("月度运营详情")]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[t._v("月度收入")]),t._v(" "),e("span",[t._v(t._s(t.detail.month_salary)+"元")])]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[t._v("设备数")]),t._v(" "),e("span",[t._v(t._s(t.detail.device_num)+"台")])]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[t._v("新装机数")]),t._v(" "),e("span",[t._v(t._s(t.detail.new_device_num)+"台")])]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[t._v("订单数")]),t._v(" "),e("span",[t._v(t._s(t.detail.month_order_num)+"单")])]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[t._v("综合评分")]),t._v(" "),e("span",[e("Rate",{attrs:{"allow-half":"",disabled:""},model:{value:t.detail.month_points,callback:function(a){t.$set(t.detail,"month_points",a)},expression:"detail.month_points"}})],1)]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[t._v("评分统计")]),t._v(" "),e("span")]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[e("Rate",{attrs:{disabled:"",value:5}})],1),t._v(" "),e("span",[t._v(t._s(t.detail.month_star_info[5]))])]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[e("Rate",{attrs:{disabled:"",value:4}})],1),t._v(" "),e("span",[t._v(t._s(t.detail.month_star_info[4]))])]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[e("Rate",{attrs:{disabled:"",value:3}})],1),t._v(" "),e("span",[t._v(t._s(t.detail.month_star_info[3]))])]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[e("Rate",{attrs:{disabled:"",value:2}})],1),t._v(" "),e("span",[t._v(t._s(t.detail.month_star_info[2]))])]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[e("Rate",{attrs:{disabled:"",value:1}})],1),t._v(" "),e("span",[t._v(t._s(t.detail.month_star_info[1]))])]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[t._v("评分字条")]),t._v(" "),e("span")]),t._v(" "),e("div",t._l(t.detail.month_comments_info,function(a,s){return e("span",{staticClass:"btn"},[t._v(t._s(s)+" "+t._s(a))])}))]),t._v(" "),e("Col",{attrs:{span:"12"}},[e("h2",{staticClass:"title"},[t._v("整体运营详情")]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[t._v("总收入")]),t._v(" "),e("span",[t._v(t._s(t.detail.total_salary)+"元")])]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[t._v("订单数")]),t._v(" "),e("span",[t._v(t._s(t.detail.total_order_num)+"单")])]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[t._v("综合评分")]),t._v(" "),e("span",[e("Rate",{attrs:{"allow-half":"",disabled:""},model:{value:t.detail.total_points,callback:function(a){t.$set(t.detail,"total_points",a)},expression:"detail.total_points"}})],1)]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[t._v("评分统计")]),t._v(" "),e("span")]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[e("Rate",{attrs:{disabled:"",value:5}})],1),t._v(" "),e("span",[t._v(t._s(t.detail.total_star_info[5]))])]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[e("Rate",{attrs:{disabled:"",value:4}})],1),t._v(" "),e("span",[t._v(t._s(t.detail.total_star_info[4]))])]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[e("Rate",{attrs:{disabled:"",value:3}})],1),t._v(" "),e("span",[t._v(t._s(t.detail.total_star_info[3]))])]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[e("Rate",{attrs:{disabled:"",value:2}})],1),t._v(" "),e("span",[t._v(t._s(t.detail.total_star_info[2]))])]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[e("Rate",{attrs:{disabled:"",value:1}})],1),t._v(" "),e("span",[t._v(t._s(t.detail.total_star_info[1]))])]),t._v(" "),e("div",{staticClass:"cell"},[e("span",[t._v("评分字条")]),t._v(" "),e("span")]),t._v(" "),e("div",t._l(t.detail.total_comments_info,function(a,s){return e("span",{staticClass:"btn"},[t._v(t._s(s)+" "+t._s(a))])}))])],1),t._v(" "),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"text"},on:{click:function(a){t.modal2=!1}}},[t._v("取消")])],1)],1)],1)},staticRenderFns:[]};var c=e("Mz/3")(o,i,!1,function(t){e("G1Dl")},"data-v-0d957206",null);a.default=c.exports}});
//# sourceMappingURL=15.109b80d18a999766a8ff.js.map