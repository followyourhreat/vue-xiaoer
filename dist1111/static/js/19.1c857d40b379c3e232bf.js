webpackJsonp([19],{qkx1:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Edqs"),r=a.n(s),o={data:function(){var t=this;return{params:{keyword:"",status:"0",role_id:""},columns:[{title:"账号",key:"username"},{title:"姓名",key:"realname"},{title:"手机号码",key:"phone"},{title:"角色",key:"role",render:function(t,e){return t("span",{},e.row.role&&e.row.role.role_name)}},{title:"状态",key:"status",render:function(t,e){return t("span",{},{1:"正常",2:"禁用"}[e.row.status])}},{title:"最近登录时间",key:"last_login_time",width:200,render:function(t,e){return t("span",{},new Date(1e3*e.row.last_login_time).Format("yyyy-MM-dd hh:mm"))}},{title:"操作",width:200,key:"operation",render:function(e,a){return e("div",[e("span",{class:"span-active",on:{click:function(){t.handleReset(a.row)}}},"密码初始化"),e("span",{class:"span-active",on:{click:function(){t.handleEdit(a.row)}}},"编辑"),e("span",{class:"span-del",on:{click:function(){t.handleRemove("operator/del",{id:a.row.id})}}},"删除")])}}],itemId:0,modal1:!1,roleList:[],formData:{username:"",realname:"",phone:"",status:"1",role_id:""},rule:{}}},computed:{modelTitle:function(){return this.itemId?"编辑":"新增"}},mounted:function(){this.getRoleList()},methods:{getRoleList:function(){var t=this;this.$post("role/list",{page:0}).then(function(e){t.roleList=e.data.list})},handleReset:function(t){var e=this;this.$Modal.confirm({title:"温馨提示",content:"确定重置密码 ?",onOk:function(){e.$post("operator/resetpwd",{id:t.id}).then(function(t){e.$Message.success("重置成功"),e.handleSearch()})},onCancel:function(){}})},handleAdd:function(){this.modal1=!0,this.itemId=0,this.$refs.form.resetFields()},handleEdit:function(t){this.modal1=!0,this.itemId=t.id,this.formData=r()({},t)},handleSubmit:function(){var t=this;if(!/^1[0-9]{10}$/.test(this.formData.phone))return this.$Message.destroy(),void this.$Message.warning("请输入正确格式的手机号");var e={};this.itemId?(e=r()({},this.formData,{id:this.itemId}),this.$post("operator/edit",e).then(function(e){t.modal1=!1,t.handleSearch(),t.$post("operator/detail",{}).then(function(e){t.$store.dispatch("setUserInfoAction",e.data)})})):(e=r()({},this.formData),this.$post("operator/add",e).then(function(e){t.modal1=!1,t.handleSearch()}))}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"dt-search-top"},[a("div",{staticClass:"dt-search-cells"},[a("div",{staticClass:"dt-search-cell"},[a("Input",{staticClass:"dt-search-input",staticStyle:{width:"350px"},attrs:{placeholder:"账号、姓名、手机号码"},model:{value:t.params.keyword,callback:function(e){t.$set(t.params,"keyword",e)},expression:"params.keyword"}})],1),t._v(" "),a("div",{staticClass:"dt-search-cell"},[t._v("\n        状态："),a("dt-select",{staticClass:"dt-search-select",attrs:{url:"userStatus"},model:{value:t.params.status,callback:function(e){t.$set(t.params,"status",e)},expression:"params.status"}})],1),t._v(" "),a("div",{staticClass:"dt-search-cell"},[t._v("\n        角色：\n        "),a("Select",{staticClass:"dt-search-select",model:{value:t.params.role_id,callback:function(e){t.$set(t.params,"role_id",e)},expression:"params.role_id"}},t._l(t.roleList,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.role_name))])}))],1)]),t._v(" "),a("div",{staticClass:"dt-search-operation"},[a("Button",{attrs:{type:"ghost"},on:{click:t.handleSearch}},[t._v("查询")]),t._v(" "),a("Button",{attrs:{type:"success"},on:{click:t.handleAdd}},[t._v("新增")])],1)]),t._v(" "),a("dt-table",{ref:"table",attrs:{url:"operator/list",params:t.params,columns:t.columns}}),t._v(" "),a("Modal",{attrs:{title:t.modelTitle,"mask-closable":!1},model:{value:t.modal1,callback:function(e){t.modal1=e},expression:"modal1"}},[a("Form",{ref:"form",attrs:{model:t.formData,rules:t.rule,"label-width":100}},[a("FormItem",{attrs:{label:"账号",prop:"username"}},[a("Input",{attrs:{placeholder:"请输入账号"},model:{value:t.formData.username,callback:function(e){t.$set(t.formData,"username",e)},expression:"formData.username"}})],1),t._v(" "),a("FormItem",{attrs:{label:"姓名",prop:"realname"}},[a("Input",{attrs:{placeholder:"请输入姓名"},model:{value:t.formData.realname,callback:function(e){t.$set(t.formData,"realname",e)},expression:"formData.realname"}})],1),t._v(" "),a("FormItem",{attrs:{label:"手机号码",prop:"phone"}},[a("Input",{attrs:{placeholder:"请输入手机号码"},model:{value:t.formData.phone,callback:function(e){t.$set(t.formData,"phone",e)},expression:"formData.phone"}})],1),t._v(" "),a("FormItem",{attrs:{label:"状态",prop:"status"}},[a("dt-select",{staticClass:"dt-search-select",attrs:{url:"userStatusModal"},model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}})],1),t._v(" "),a("FormItem",{attrs:{label:"角色",prop:"role_id"}},[a("Select",{model:{value:t.formData.role_id,callback:function(e){t.$set(t.formData,"role_id",e)},expression:"formData.role_id"}},t._l(t.roleList,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.role_name))])}))],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"ghost"},on:{click:function(e){t.handleSubmit()}}},[t._v("保存")]),t._v(" "),a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"text"},on:{click:function(e){t.modal1=!1}}},[t._v("取消")])],1)],1)],1)},staticRenderFns:[]},n=a("Mz/3")(o,l,!1,null,null,null);e.default=n.exports}});
//# sourceMappingURL=19.1c857d40b379c3e232bf.js.map